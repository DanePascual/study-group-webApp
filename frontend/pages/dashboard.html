<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.0/font/bootstrap-icons.min.css"
      rel="stylesheet"
    />
    <title>Dashboard - Study Group</title>
    <style>
      :root {
        --primary-color: #4caf50;
        --primary-hover: #388e3c;
        --primary-light: #e8f5e8;
        --secondary-color: #2196f3;
        --secondary-light: #e3f2fd;
        --warning-color: #ff9800;
        --danger-color: #f44336;
        --dark-text: #333;
        --medium-text: #666;
        --light-text: #888;
        --border-light: #e0e0e0;
        --background-light: #f8f9fa;
        --shadow-light: rgba(0, 0, 0, 0.1);
        --shadow-medium: rgba(0, 0, 0, 0.15);
        --border-radius: 12px;
        --transition: all 0.3s ease;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", "Arial", sans-serif;
        background: var(--background-light);
        overflow-x: hidden;
        transition: var(--transition);
        color: var(--dark-text);
      }

      /* Enhanced Dark mode styles */
      body.dark-mode {
        --dark-text: #e0e0e0;
        --medium-text: #bbb;
        --light-text: #999;
        --background-light: #1a1a1a;
        --border-light: #333;
        background: #1a1a1a;
        color: var(--dark-text);
      }

      body.dark-mode .sidebar {
        background: linear-gradient(135deg, #2e5d31 0%, #4a7c4f 100%);
      }

      body.dark-mode .top-nav,
      body.dark-mode .study-rooms,
      body.dark-mode .todo-section {
        background: #2a2a2a;
        color: var(--dark-text);
      }

      body.dark-mode .room-card,
      body.dark-mode .todo-item {
        background: #333;
        color: var(--dark-text);
      }

      /* Fix search input in dark mode */
      body.dark-mode .search-input {
        background: #333;
        border-color: #444;
        color: var(--dark-text);
      }

      body.dark-mode .search-input::placeholder {
        color: var(--light-text);
      }

      body.dark-mode .search-input:focus {
        background: #3a3a3a;
        border-color: var(--primary-color);
      }

      /* Fix form inputs in dark mode */
      body.dark-mode .form-input,
      body.dark-mode .form-textarea {
        background: #333;
        border-color: #444;
        color: var(--dark-text);
      }

      body.dark-mode .form-input::placeholder,
      body.dark-mode .form-textarea::placeholder {
        color: var(--light-text);
      }

      body.dark-mode .form-input:focus,
      body.dark-mode .form-textarea:focus {
        background: #3a3a3a;
        border-color: var(--primary-color);
      }

      /* Fix modal in dark mode */
      body.dark-mode .todo-modal-content {
        background: #2a2a2a;
        color: var(--dark-text);
      }

      body.dark-mode .modal-title {
        color: var(--dark-text);
      }

      body.dark-mode .form-label {
        color: var(--dark-text);
      }

      /* Fix text colors in dark mode */
      body.dark-mode .section-title {
        color: var(--dark-text);
      }

      body.dark-mode .page-title {
        color: var(--dark-text);
      }

      body.dark-mode .room-title {
        color: var(--dark-text);
      }

      body.dark-mode .room-description {
        color: var(--medium-text);
      }

      body.dark-mode .todo-text {
        color: var(--dark-text);
      }

      body.dark-mode .participant-count {
        color: var(--medium-text);
      }

      /* Sidebar Styles */
      .sidebar {
        position: fixed;
        left: -280px;
        top: 0;
        width: 280px;
        height: 100vh;
        background: linear-gradient(135deg, #4caf50 0%, #66bb6a 100%);
        transition: left 0.3s ease;
        z-index: 1000;
        box-shadow: 2px 0 20px var(--shadow-light);
      }

      .sidebar.open {
        left: 0;
      }

      .sidebar-header {
        padding: 20px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .sidebar-brand {
        color: white;
        font-size: 18px;
        font-weight: bold;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .sidebar-menu {
        padding: 20px 0;
      }

      .sidebar-item {
        display: block;
        color: white;
        text-decoration: none;
        padding: 15px 20px;
        transition: var(--transition);
        border-left: 3px solid transparent;
        position: relative;
        overflow: hidden;
      }

      .sidebar-item::before {
        content: "";
        position: absolute;
        left: 0;
        top: 0;
        width: 0;
        height: 100%;
        background: rgba(255, 255, 255, 0.1);
        transition: width 0.3s ease;
      }

      .sidebar-item:hover::before,
      .sidebar-item.active::before {
        width: 100%;
      }

      .sidebar-item:hover,
      .sidebar-item.active {
        background: rgba(255, 255, 255, 0.1);
        border-left-color: white;
        color: white;
        
      }

      .sidebar-item i {
        width: 20px;
        margin-right: 10px;
        position: relative;
        z-index: 2;
      }

      .sidebar-item span {
        position: relative;
        z-index: 2;
      }

      .sidebar-footer {
        position: absolute;
        bottom: 20px;
        width: 100%;
        padding: 0 20px;
      }

      .user-info {
        display: flex;
        align-items: center;
        gap: 10px;
        color: white;
        background: rgba(255, 255, 255, 0.1);
        padding: 15px;
        border-radius: 10px;
        cursor: pointer;
        transition: var(--transition);
      }

      .user-info:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: translateY(-2px);
      }

      .user-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: var(--primary-color);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
      }

      /* Main Content */
      .main-content {
        margin-left: 0;
        transition: margin-left 0.3s ease;
        min-height: 100vh;
      }

      .main-content.shifted {
        margin-left: 280px;
      }

      /* Top Navigation - WITHOUT CLOCK */
      .top-nav {
        background: white;
        padding: 15px 30px;
        box-shadow: 0 2px 20px var(--shadow-light);
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: sticky;
        top: 0;
        z-index: 100;
        backdrop-filter: blur(10px);
      }

      .nav-left {
        display: flex;
        align-items: center;
        gap: 20px;
      }

      .menu-toggle {
        background: none;
        border: none;
        font-size: 20px;
        color: var(--medium-text);
        cursor: pointer;
        padding: 8px;
        border-radius: 8px;
        transition: var(--transition);
      }

      .menu-toggle:hover {
        background: var(--background-light);
        transform: scale(1.1);
      }

      .page-title {
        font-size: 24px;
        font-weight: 600;
        color: var(--dark-text);
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .nav-right {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .search-bar {
        position: relative;
      }

      .search-input {
        width: 300px;
        padding: 10px 40px 10px 15px;
        border: 1px solid var(--border-light);
        border-radius: 25px;
        font-size: 14px;
        transition: var(--transition);
        background: var(--background-light);
        color: var(--dark-text);
      }

      .search-input:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        width: 350px;
      }

      .search-icon {
        position: absolute;
        right: 15px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--light-text);
      }

      .theme-toggle {
        background: none;
        border: none;
        font-size: 18px;
        color: var(--medium-text);
        cursor: pointer;
        padding: 8px;
        border-radius: 8px;
        transition: var(--transition);
      }

      .theme-toggle:hover {
        background: var(--background-light);
        transform: scale(1.1);
      }

      /* Dashboard Content */
      .dashboard-content {
        padding: 30px;
        animation: fadeIn 0.6s ease-out;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .content-row {
        display: flex;
        gap: 30px;
        margin-bottom: 30px;
      }

      .main-section {
        flex: 2;
      }

      .side-section {
        flex: 1;
        max-width: 400px;
      }

      /* Fix section title size */
      .section-title {
        font-size: 20px;
        font-weight: 600;
        color: var(--dark-text);
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      /* Study Rooms Section */
      .study-rooms {
        background: white;
        border-radius: var(--border-radius);
        padding: 25px;
        box-shadow: 0 5px 20px var(--shadow-light);
        transition: var(--transition);
        margin-bottom: 30px;
      }

      .study-rooms:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 30px var(--shadow-medium);
      }

      .room-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
      }

      .room-card {
        background: var(--background-light);
        border-radius: var(--border-radius);
        padding: 20px;
        transition: var(--transition);
        border: 2px solid transparent;
        position: relative;
        overflow: hidden;
      }

      .room-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, var(--primary-color), #66bb6a);
        transform: scaleX(0);
        transition: transform 0.3s ease;
      }

      .room-card:hover::before {
        transform: scaleX(1);
      }

      .room-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px var(--shadow-medium);
        border-color: var(--primary-color);
      }

      .room-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 15px;
      }

      .room-title {
        font-size: 16px;
        font-weight: 600;
        color: var(--dark-text);
        margin-bottom: 5px;
      }

      .room-description {
        font-size: 13px;
        color: var(--medium-text);
        line-height: 1.5;
      }

      .room-tags {
        display: flex;
        gap: 8px;
        margin: 15px 0;
        flex-wrap: wrap;
      }

      .room-tag {
        background: var(--primary-light);
        color: var(--primary-hover);
        padding: 4px 12px;
        border-radius: 15px;
        font-size: 11px;
        font-weight: 500;
        transition: var(--transition);
      }

      .room-tag:hover {
        background: var(--primary-color);
        color: white;
        transform: translateY(-1px);
      }

      .room-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 15px;
      }

      .participant-count {
        font-size: 13px;
        color: var(--medium-text);
        display: flex;
        align-items: center;
        gap: 5px;
      }

      .join-btn {
        background: var(--primary-color);
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 500;
        cursor: pointer;
        transition: var(--transition);
      }

      .join-btn:hover {
        background: var(--primary-hover);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
      }

      /* To-Do Section */
      .todo-section {
        background: white;
        border-radius: var(--border-radius);
        padding: 25px;
        box-shadow: 0 5px 20px var(--shadow-light);
        margin-bottom: 20px;
        transition: var(--transition);
      }

      .todo-section:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 30px var(--shadow-medium);
      }

      .todo-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .add-todo-btn {
        background: var(--primary-color);
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 500;
        cursor: pointer;
        transition: var(--transition);
      }

      .add-todo-btn:hover {
        background: var(--primary-hover);
        transform: translateY(-1px);
      }

      .todo-item {
        background: var(--background-light);
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 10px;
        border-left: 4px solid var(--primary-color);
        transition: var(--transition);
        animation: slideInLeft 0.3s ease-out;
      }

      @keyframes slideInLeft {
        from {
          transform: translateX(-20px);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }

      .todo-item:hover {
        transform: translateX(5px);
        box-shadow: 0 3px 15px var(--shadow-light);
      }

      .todo-item.completed {
        opacity: 0.6;
        border-left-color: var(--light-text);
      }

      .todo-content {
        display: flex;
        align-items: flex-start;
        gap: 10px;
      }

      .todo-checkbox {
        margin-top: 3px;
        transform: scale(1.2);
      }

      .todo-text {
        flex: 1;
        font-size: 14px;
        line-height: 1.4;
        color: var(--dark-text);
      }

      .todo-text.completed {
        text-decoration: line-through;
        color: var(--medium-text);
      }

      .todo-meta {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 10px;
        font-size: 12px;
        color: var(--medium-text);
      }

      .todo-reminder {
        display: flex;
        align-items: center;
        gap: 5px;
      }

      .todo-actions {
        display: flex;
        gap: 5px;
      }

      .todo-action-btn {
        background: none;
        border: none;
        color: var(--medium-text);
        font-size: 12px;
        cursor: pointer;
        padding: 4px 6px;
        border-radius: 4px;
        transition: var(--transition);
      }

      .todo-action-btn:hover {
        background: var(--border-light);
        color: var(--dark-text);
        transform: scale(1.1);
      }

      /* Responsive Design - Improved Search Bar */
      /* Large screens */
      @media (min-width: 1200px) {
        .search-input {
          width: 300px;
        }
        .search-input:focus {
          width: 350px;
        }
      }
      
      /* Medium screens */
      @media (max-width: 1199px) and (min-width: 992px) {
        .search-input {
          width: 250px;
        }
        .search-input:focus {
          width: 280px;
        }
      }
      
      /* Small screens */
      @media (max-width: 991px) and (min-width: 768px) {
        .search-input {
          width: 200px;
        }
        .search-input:focus {
          width: 220px;
        }
      }
      
      /* Extra small screens */
      @media (max-width: 767px) {
        .search-input {
          width: 150px;
        }
        .search-input:focus {
          width: 170px;
        }
        .page-title {
          font-size: 20px;
        }
      }
      
      /* Very small screens */
      @media (max-width: 480px) {
        .search-input {
          width: 120px;
          padding: 8px 30px 8px 12px;
          font-size: 13px;
        }
        .search-input:focus {
          width: 140px;
        }
        .search-icon {
          right: 10px;
        }
        .page-title {
          font-size: 18px;
        }
        .top-nav {
          padding: 12px 15px;
        }
        .nav-right {
          gap: 8px;
        }
      }
      
      /* Extremely small screens - enhance mobile view */
      @media (max-width: 360px) {
        .search-input {
          width: 100px;
          padding: 6px 25px 6px 10px;
          font-size: 12px;
        }
        .search-input:focus {
          width: 110px;
        }
        .search-icon {
          right: 8px;
          font-size: 12px;
        }
        .page-title {
          font-size: 16px;
        }
        .nav-left {
          gap: 10px;
        }
        .menu-toggle {
          padding: 5px;
        }
        .top-nav {
          padding: 10px 12px;
        }
        .nav-right {
          gap: 5px;
        }
        .theme-toggle {
          padding: 5px;
          font-size: 16px;
        }
      }

      @media (max-width: 768px) {
        .main-content.shifted {
          margin-left: 0;
        }

        .content-row {
          flex-direction: column;
        }

        .room-grid {
          grid-template-columns: 1fr;
        }

        .dashboard-content {
          padding: 20px;
        }

        .nav-right {
          gap: 10px;
        }
      }

      /* Loading animations */
      .loading {
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
        100% {
          opacity: 1;
        }
      }

      /* Accessibility improvements */
      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
      }

      /* Focus styles for better accessibility */
      *:focus-visible {
        outline: 2px solid var(--primary-color);
        outline-offset: 2px;
      }

      /* Modal Styles */
      .todo-modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(5px);
        animation: fadeIn 0.3s ease-out;
      }

      .todo-modal-content {
        background: white;
        margin: 5% auto;
        padding: 30px;
        border-radius: var(--border-radius);
        width: 90%;
        max-width: 500px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        animation: slideInDown 0.3s ease-out;
      }

      @keyframes slideInDown {
        from {
          transform: translateY(-50px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .modal-title {
        font-size: 18px;
        font-weight: 600;
        color: var(--dark-text);
      }

      .close-modal {
        background: none;
        border: none;
        font-size: 24px;
        color: var(--medium-text);
        cursor: pointer;
        padding: 5px;
        border-radius: 50%;
        transition: var(--transition);
      }

      .close-modal:hover {
        background: var(--border-light);
        transform: scale(1.1);
      }

      .form-group {
        margin-bottom: 20px;
      }

      .form-label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        color: var(--dark-text);
      }

      .form-input,
      .form-textarea {
        width: 100%;
        padding: 12px;
        border: 1px solid var(--border-light);
        border-radius: 8px;
        font-size: 14px;
        transition: var(--transition);
        background: var(--background-light);
        color: var(--dark-text);
      }

      .form-textarea {
        resize: vertical;
        min-height: 80px;
      }

      .form-input:focus,
      .form-textarea:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
      }

      .modal-actions {
        display: flex;
        gap: 10px;
        justify-content: flex-end;
      }

      .modal-btn {
        padding: 10px 20px;
        border: none;
        border-radius: 8px;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        transition: var(--transition);
      }

      .modal-btn-cancel {
        background: var(--background-light);
        color: var(--medium-text);
      }

      .modal-btn-save {
        background: var(--primary-color);
        color: white;
      }

      .modal-btn:hover {
        transform: translateY(-1px);
      }

      .modal-btn-cancel:hover {
        background: var(--border-light);
      }

      .modal-btn-save:hover {
        background: var(--primary-hover);
      }
    </style>
  </head>
  <body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-brand">
          <i class="bi bi-book"></i>
          StudyGroup
        </div>
      </div>

      <nav class="sidebar-menu" role="navigation">
        <a
          href="dashboard.html"
          class="sidebar-item active"
          aria-current="page"
        >
          <i class="bi bi-house"></i>
          <span>Dashboard</span>
        </a>
        <a href="profile.html" class="sidebar-item">
          <i class="bi bi-person"></i>
          <span>Profile</span>
        </a>
        <a href="study-rooms.html" class="sidebar-item">
          <i class="bi bi-door-open"></i>
          <span>Study Rooms</span>
        </a>
        <a href="resources.html" class="sidebar-item">
          <i class="bi bi-folder"></i>
          <span>Resources</span>
        </a>
        <a href="discussion.html" class="sidebar-item">
          <i class="bi bi-chat-dots"></i>
          <span>Discussion Forum</span>
        </a>
        <a href="report.html" class="sidebar-item">
          <i class="bi bi-flag"></i>
          <span>Report</span>
        </a>
      </nav>

      <!-- FIXED: Changed the sidebar-footer to use a proper direct link -->
      <div class="sidebar-footer">
        <a href="profile.html" style="text-decoration: none; display: block; width: 100%;">
          <div class="user-info" id="profileLink">
            <div class="user-avatar">DP</div>
            <div>
              <div style="font-weight: bold; font-size: 14px">DanePascual</div>
              <div style="font-size: 12px; opacity: 0.8">BSIT</div>
            </div>
          </div>
        </a>
      </div>
    </div>

    <!-- Main Content -->
    <div class="main-content" id="mainContent">
      <!-- Top Navigation - WITHOUT CLOCK -->
      <div class="top-nav">
        <div class="nav-left">
          <button
            class="menu-toggle"
            id="menuToggle"
            aria-label="Toggle sidebar"
          >
            <i class="bi bi-list"></i>
          </button>
          <h1 class="page-title">Dashboard</h1>
        </div>

        <div class="nav-right">
          <div class="search-bar">
            <input
              type="text"
              class="search-input"
              placeholder="Search..."
              aria-label="Search"
            />
            <i class="bi bi-search search-icon"></i>
          </div>
          <button
            class="theme-toggle"
            id="themeToggle"
            aria-label="Toggle theme"
          >
            <i class="bi bi-moon"></i>
          </button>
        </div>
      </div>

      <!-- Dashboard Content -->
      <div class="dashboard-content">
        <div class="content-row">
          <!-- Main Section -->
          <div class="main-section">
            <!-- Active Study Rooms -->
            <div class="study-rooms">
              <h2 class="section-title">
                <i class="bi bi-door-open"></i>
                Active Study Rooms
              </h2>
              <div class="room-grid">
                <div class="room-card" data-room-id="cs">
                  <div class="room-header">
                    <div>
                      <h3 class="room-title">CS Study Room</h3>
                      <p class="room-description">
                        Solving problems related to algorithms and data
                        structures.
                      </p>
                    </div>
                  </div>
                  <div class="room-tags">
                    <span class="room-tag">Programming</span>
                    <span class="room-tag">Algorithms</span>
                  </div>
                  <div class="room-footer">
                    <span class="participant-count">
                      <i class="bi bi-people"></i>
                      <span id="cs-count">3</span> participants
                    </span>
                    <button class="join-btn" onclick="joinRoom('cs')">
                      Join Now
                    </button>
                  </div>
                </div>

                <div class="room-card" data-room-id="web-dev">
                  <div class="room-header">
                    <div>
                      <h3 class="room-title">Web Development Study</h3>
                      <p class="room-description">
                        Building modern web applications with React and Node.js.
                      </p>
                    </div>
                  </div>
                  <div class="room-tags">
                    <span class="room-tag">JavaScript</span>
                    <span class="room-tag">React</span>
                    <span class="room-tag">Node.js</span>
                  </div>
                  <div class="room-footer">
                    <span class="participant-count">
                      <i class="bi bi-people"></i>
                      <span id="web-dev-count">7</span> participants
                    </span>
                    <button class="join-btn" onclick="joinRoom('web-dev')">
                      Join Now
                    </button>
                  </div>
                </div>

                <div class="room-card" data-room-id="database">
                  <div class="room-header">
                    <div>
                      <h3 class="room-title">Database Design</h3>
                      <p class="room-description">
                        Learning SQL, database optimization and design patterns.
                      </p>
                    </div>
                  </div>
                  <div class="room-tags">
                    <span class="room-tag">SQL</span>
                    <span class="room-tag">PostgreSQL</span>
                  </div>
                  <div class="room-footer">
                    <span class="participant-count">
                      <i class="bi bi-people"></i>
                      <span id="database-count">5</span> participants
                    </span>
                    <button class="join-btn" onclick="joinRoom('database')">
                      Join Now
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Side Section -->
          <div class="side-section">
            <!-- To-Do Lists -->
            <div class="todo-section">
              <div class="todo-header">
                <h3 class="section-title">
                  <i class="bi bi-check2-square"></i>
                  Study Notes & Tasks
                </h3>
                <button class="add-todo-btn" onclick="openTodoModal()">
                  <i class="bi bi-plus"></i> Add Task
                </button>
              </div>

              <div id="todoList">
                <!-- Todo items will be rendered here -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Todo Modal -->
    <div
      id="todoModal"
      class="todo-modal"
      role="dialog"
      aria-labelledby="modalTitle"
      aria-hidden="true"
    >
      <div class="todo-modal-content">
        <div class="modal-header">
          <h3 class="modal-title" id="modalTitle">Add Study Task & Reminder</h3>
          <button
            class="close-modal"
            onclick="closeTodoModal()"
            aria-label="Close modal"
          >
            ×
          </button>
        </div>

        <form id="todoForm">
          <div class="form-group">
            <label class="form-label" for="todoText">Task/Note</label>
            <textarea
              class="form-textarea"
              id="todoText"
              placeholder="Enter your study task or note..."
              required
            ></textarea>
          </div>

          <div class="form-group">
            <label class="form-label" for="todoReminder"
              >Reminder Date & Time (Optional)</label
            >
            <input type="datetime-local" class="form-input" id="todoReminder" />
          </div>

          <div class="modal-actions">
            <button
              type="button"
              class="modal-btn modal-btn-cancel"
              onclick="closeTodoModal()"
            >
              Cancel
            </button>
            <button type="submit" class="modal-btn modal-btn-save">
              Save Task
            </button>
          </div>
        </form>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script>
      // UPDATED: Current Session Info with latest timestamp
      const CURRENT_SESSION = {
        utcTime: "2025-08-29 16:00:02", // UTC time
        philippinesTime: "2025-08-30 00:00:02", // Philippines time (UTC+8)
        datetime: "2025-08-30 00:00:02", // Local Philippines time for compatibility
        user: "DanePascual",
        userAvatar: "DP",
        userProgram: "BSIT",
        timezone: "Asia/Manila"
      };

      // Theme management
      const themeToggle = document.getElementById("themeToggle");
      const body = document.body;

      // Load saved theme
      const savedTheme = localStorage.getItem("theme") || "light";
      if (savedTheme === "dark") {
        body.classList.add("dark-mode");
        themeToggle.innerHTML = '<i class="bi bi-sun"></i>';
      }

      themeToggle.addEventListener("click", () => {
        body.classList.toggle("dark-mode");
        const isDark = body.classList.contains("dark-mode");
        themeToggle.innerHTML = isDark
          ? '<i class="bi bi-sun"></i>'
          : '<i class="bi bi-moon"></i>';
        localStorage.setItem("theme", isDark ? "dark" : "light");

        console.log(
          `Theme switched to ${isDark ? "dark" : "light"} mode by ${
            CURRENT_SESSION.user
          }`
        );
      });

      // Enhanced sidebar functionality
      const menuToggle = document.getElementById("menuToggle");
      const sidebar = document.getElementById("sidebar");
      const mainContent = document.getElementById("mainContent");

      menuToggle.addEventListener("click", function () {
        sidebar.classList.toggle("open");
        mainContent.classList.toggle("shifted");

        // Save sidebar state
        localStorage.setItem("sidebarOpen", sidebar.classList.contains("open"));
      });

      // Load saved sidebar state
      document.addEventListener("DOMContentLoaded", () => {
        const sidebarOpen = localStorage.getItem("sidebarOpen") === "true";
        if (sidebarOpen && window.innerWidth > 768) {
          sidebar.classList.add("open");
          mainContent.classList.add("shifted");
        }
        
        // ADDED: Force the profile link to use direct navigation
        document.getElementById("profileLink").addEventListener("click", function(e) {
          console.log("Profile link clicked - ensuring navigation to profile.html");
          window.location.href = "profile.html";
        });
      });

      // Close sidebar when clicking outside on mobile
      document.addEventListener("click", function (event) {
        if (window.innerWidth <= 768) {
          if (
            !sidebar.contains(event.target) &&
            !menuToggle.contains(event.target) &&
            sidebar.classList.contains("open")
          ) {
            sidebar.classList.remove("open");
            mainContent.classList.remove("shifted");
          }
        }
      });

      // Enhanced search functionality with suggestions
      const searchInput = document.querySelector(".search-input");
      let searchTimeout;

      searchInput.addEventListener("input", function (e) {
        clearTimeout(searchTimeout);
        const query = e.target.value.trim();

        if (query.length > 1) {
          searchTimeout = setTimeout(() => {
            performSearch(query);
          }, 300);
        }
      });

      function performSearch(query) {
        // Mock search functionality - replace with actual API call
        const mockResults = [
          {
            type: "room",
            name: "CS Study Room",
            description: "Algorithms and data structures",
          },
          { type: "user", name: "John Doe", description: "BSIT Student" },
          {
            type: "resource",
            name: "React Tutorial",
            description: "Frontend development guide",
          },
        ];

        const filtered = mockResults.filter(
          (item) =>
            item.name.toLowerCase().includes(query.toLowerCase()) ||
            item.description.toLowerCase().includes(query.toLowerCase())
        );

        console.log("Search results for:", query, filtered);
      }

      // Function for joining rooms
      function joinRoom(roomType) {
        const rooms = {
          cs: "CS Study Room",
          "web-dev": "Web Development Study",
          database: "Database Design",
        };

        // Simulate joining
        setTimeout(() => {
          window.location.href = `study-room-inside.html?room=${roomType}`;
        }, 500);
      }

      // Modified to not show notifications
      function showNotification(message, type = "info") {
        // Log to console instead
        console.log(`${type}: ${message}`);
      }

      // Enhanced Todo Management
      let editingTodoIndex = -1;
      let todos = JSON.parse(localStorage.getItem("studyTasks") || "[]");

      // Initialize with some sample todos if empty
      if (todos.length === 0) {
        todos = [
          {
            id: Date.now() - 1000,
            text: "Complete React tutorial from CS Study Room",
            completed: false,
            reminder: null,
            created: new Date().toISOString(),
            priority: "high",
          },
          {
            id: Date.now() - 2000,
            text: "Review database normalization concepts",
            completed: true,
            reminder: null,
            created: new Date().toISOString(),
            priority: "medium",
          },
          {
            id: Date.now() - 3000,
            text: "Prepare for algorithms quiz on Friday",
            completed: false,
            reminder: "2025-08-31T14:00",
            created: new Date().toISOString(),
            priority: "high",
          },
        ];
        localStorage.setItem("studyTasks", JSON.stringify(todos));
      }

      function openTodoModal() {
        document.getElementById("todoModal").style.display = "block";
        document.getElementById("todoText").value = "";
        document.getElementById("todoReminder").value = "";
        editingTodoIndex = -1;
        document.querySelector(".modal-title").textContent =
          "Add Study Task & Reminder";
        document.getElementById("todoText").focus();
      }

      function closeTodoModal() {
        document.getElementById("todoModal").style.display = "none";
      }

      function saveTodo() {
        const text = document.getElementById("todoText").value.trim();
        const reminder = document.getElementById("todoReminder").value;

        if (!text) {
          showNotification("Please enter a task description!", "error");
          return;
        }

        const todo = {
          id: Date.now(),
          text: text,
          completed: false,
          reminder: reminder,
          created: new Date().toISOString(),
          priority: "medium",
        };

        if (editingTodoIndex >= 0) {
          todos[editingTodoIndex] = {
            ...todos[editingTodoIndex],
            text: text,
            reminder: reminder,
          };
          showNotification("Task updated successfully!", "success");
        } else {
          todos.unshift(todo);
          showNotification("New task added!", "success");
        }

        localStorage.setItem("studyTasks", JSON.stringify(todos));
        renderTodos();
        closeTodoModal();
      }

      function renderTodos() {
        const todoList = document.getElementById("todoList");

        if (todos.length === 0) {
          todoList.innerHTML = `
            <div style="text-align: center; padding: 30px; color: var(--medium-text);">
              <i class="bi bi-journal-text" style="font-size: 48px; margin-bottom: 15px; display: block; opacity: 0.5;"></i>
              <p>No study tasks yet.</p>
              <p style="font-size: 12px;">Click "Add Task" to create your first reminder!</p>
            </div>
          `;
          return;
        }

        const sortedTodos = [...todos].sort((a, b) => {
          if (a.completed !== b.completed) return a.completed - b.completed;
          const priorityOrder = { high: 0, medium: 1, low: 2 };
          if (a.priority !== b.priority)
            return priorityOrder[a.priority] - priorityOrder[b.priority];
          return new Date(b.created) - new Date(a.created);
        });

        todoList.innerHTML = sortedTodos
          .map((todo, index) => {
            const originalIndex = todos.findIndex((t) => t.id === todo.id);
            const priorityColor =
              todo.priority === "high"
                ? "#f44336"
                : todo.priority === "medium"
                ? "#ff9800"
                : "#4caf50";

            return `
              <div class="todo-item ${
                todo.completed ? "completed" : ""
              }" style="border-left-color: ${priorityColor}">
                <div class="todo-content">
                  <input type="checkbox" class="todo-checkbox" ${
                    todo.completed ? "checked" : ""
                  } onchange="toggleTodo(${originalIndex})">
                  <div class="todo-text ${todo.completed ? "completed" : ""}">${
              todo.text
            }</div>
                </div>
                <div class="todo-meta">
                  <div class="todo-reminder">
                    <i class="bi bi-clock"></i>
                    <span>${
                      todo.reminder
                        ? formatReminderDate(todo.reminder)
                        : "No reminder"
                    }</span>
                  </div>
                  <div class="todo-actions">
                    <button class="todo-action-btn" onclick="editTodo(${originalIndex})" title="Edit task">
                      <i class="bi bi-pencil"></i>
                    </button>
                    <button class="todo-action-btn" onclick="deleteTodo(${originalIndex})" title="Delete task">
                      <i class="bi bi-trash"></i>
                    </button>
                  </div>
                </div>
              </div>
            `;
          })
          .join("");
      }

      function toggleTodo(index) {
        todos[index].completed = !todos[index].completed;
        localStorage.setItem("studyTasks", JSON.stringify(todos));
        renderTodos();

        const action = todos[index].completed ? "completed" : "reopened";
        showNotification(`Task ${action}!`, "success");
      }

      function editTodo(index) {
        editingTodoIndex = index;
        const todo = todos[index];
        document.getElementById("todoText").value = todo.text;
        document.getElementById("todoReminder").value = todo.reminder || "";
        document.querySelector(".modal-title").textContent = "Edit Study Task";
        document.getElementById("todoModal").style.display = "block";
        document.getElementById("todoText").focus();
      }

      function deleteTodo(index) {
        if (confirm("Are you sure you want to delete this task?")) {
          todos.splice(index, 1);
          localStorage.setItem("studyTasks", JSON.stringify(todos));
          renderTodos();
          showNotification("Task deleted!", "info");
        }
      }

      function formatReminderDate(dateString) {
        if (!dateString) return "No reminder";

        const date = new Date(dateString);
        const now = new Date();
        const diffMs = date.getTime() - now.getTime();
        const diffHours = diffMs / (1000 * 60 * 60);

        if (diffHours < 0) {
          return "Overdue";
        } else if (diffHours < 1) {
          const diffMins = Math.floor(diffMs / (1000 * 60));
          return `${diffMins} mins`;
        } else if (diffHours < 24) {
          return `${Math.floor(diffHours)}h`;
        } else {
          const diffDays = Math.floor(diffHours / 24);
          return `${diffDays}d`;
        }
      }

      // Todo Form Submit
      document
        .getElementById("todoForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();
          saveTodo();
        });

      // Close modal when clicking outside
      document
        .getElementById("todoModal")
        .addEventListener("click", function (e) {
          if (e.target === this) {
            closeTodoModal();
          }
        });

      // Keyboard shortcuts
      document.addEventListener("keydown", function (e) {
        if ((e.ctrlKey || e.metaKey) && e.key === "n") {
          e.preventDefault();
          openTodoModal();
        }

        if (e.key === "Escape") {
          closeTodoModal();
        }

        if ((e.ctrlKey || e.metaKey) && e.key === "k") {
          e.preventDefault();
          searchInput.focus();
        }

        if ((e.ctrlKey || e.metaKey) && e.key === "t") {
          e.preventDefault();
          themeToggle.click();
        }
      });

      // Real-time participant count updates (simulated)
      function updateParticipantCounts() {
        const rooms = ["cs", "web-dev", "database"];
        rooms.forEach((room) => {
          const countElement = document.getElementById(`${room}-count`);
          if (countElement) {
            const currentCount = parseInt(countElement.textContent);
            const variation = Math.floor(Math.random() * 3) - 1;
            const newCount = Math.max(0, currentCount + variation);
            countElement.textContent = newCount;
          }
        });
      }

      setInterval(updateParticipantCounts, 30000);

      // User session validation
      function validateUserSession() {
        localStorage.setItem("currentUser", CURRENT_SESSION.user);
        localStorage.setItem("currentSession", JSON.stringify(CURRENT_SESSION));
        console.log(`Dashboard session validated for ${CURRENT_SESSION.user}`);
      }

      // Initialize dashboard
      document.addEventListener("DOMContentLoaded", function () {
        // Validate user session
        validateUserSession();

        // Render todos
        renderTodos();

        // Animate elements on load
        const animatedElements = document.querySelectorAll(".room-card");
        animatedElements.forEach((element, index) => {
          element.style.opacity = "0";
          element.style.transform = "translateY(20px)";

          setTimeout(() => {
            element.style.transition = "all 0.6s ease-out";
            element.style.opacity = "1";
            element.style.transform = "translateY(0)";
          }, index * 100);
        });

        // Update search placeholder for mobile
        function updateSearchPlaceholder() {
          const width = window.innerWidth;
          if (width <= 360) {
            searchInput.placeholder = "Search...";
          } else if (width <= 480) {
            searchInput.placeholder = "Search...";
          } else {
            searchInput.placeholder = "Search dashboard...";
          }
        }
        
        // Initial call and setup resize listener
        updateSearchPlaceholder();
        window.addEventListener('resize', updateSearchPlaceholder);

        console.log(`Dashboard ready for ${CURRENT_SESSION.user}`);
      });

      // Export functions for potential use by other scripts
      window.StudyDashboard = {
        showNotification,
        openTodoModal,
        closeTodoModal,
        joinRoom,
        validateUserSession,
        currentUser: CURRENT_SESSION.user,
        currentSession: CURRENT_SESSION.datetime,
      };
    </script>
  </body>
</html>