<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Resources - Study Group</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.0/font/bootstrap-icons.min.css"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      :root {
        --primary-color: #4caf50;
        --primary-dark: #388e3c;
        --primary-darker: #2e7d32;
        --primary-light: #66bb6a;
        --primary-lighter: #e8f5e9;
        --accent-color: #ff9800;
        --text-dark: #333;
        --text-medium: #666;
        --text-light: #888;
        --background-color: #f8f9fa;
        --background-gradient: linear-gradient(135deg, #f8f9fa 65%, #e8f5e9 100%);
        --card-background: #ffffff;
        --border-color: #e0e0e0;
        --shadow-sm: 0 2px 10px rgba(0, 0, 0, 0.1);
        --shadow-md: 0 4px 16px rgba(76, 175, 80, 0.08);
        --transition-normal: all 0.2s ease;
        --transition-slow: all 0.3s ease;
        --border-radius-sm: 8px;
        --border-radius-md: 15px;
        --border-radius-lg: 20px;
      }
      
      /* Dark Mode Variables */
      body.dark-mode {
        --text-dark: #e0e0e0;
        --text-medium: #bbb;
        --text-light: #999;
        --background-color: #1a1a1a;
        --background-gradient: #1a1a1a;
        --card-background: #2a2a2a;
        --border-color: #444;
        --shadow-sm: 0 2px 10px rgba(0, 0, 0, 0.3);
        --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.3);
        --primary-lighter: #2c3b2d;
      }

      body {
        font-family: "Arial", sans-serif;
        background: var(--background-color);
        overflow-x: hidden;
        color: var(--text-dark);
        line-height: 1.6;
        transition: var(--transition-slow);
      }

      /* Skeleton loading animation */
      @keyframes shimmer {
        0% {
          background-position: -1000px 0;
        }
        100% {
          background-position: 1000px 0;
        }
      }

      .skeleton {
        background: linear-gradient(
          90deg,
          #f0f0f0 25%,
          #e0e0e0 50%,
          #f0f0f0 75%
        );
        background-size: 1000px 100%;
        animation: shimmer 2s infinite linear;
        border-radius: var(--border-radius-sm);
      }

      body.dark-mode .skeleton {
        background: linear-gradient(
          90deg,
          #333 25%,
          #3a3a3a 50%,
          #333 75%
        );
      }

      /* Animations */
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes slideIn {
        from {
          transform: translateX(100%);
        }
        to {
          transform: translateX(0);
        }
      }

      @keyframes scaleIn {
        from {
          transform: scale(0.95);
          opacity: 0;
        }
        to {
          transform: scale(1);
          opacity: 1;
        }
      }

      /* Theme toggle button */
      .theme-toggle {
        background: none;
        border: none;
        font-size: 18px;
        color: var(--text-medium);
        cursor: pointer;
        padding: 8px;
        border-radius: 50%;
        transition: all 0.3s ease;
        margin-right: 15px;
      }
      
      .theme-toggle:hover {
        background: rgba(0,0,0,0.05);
        transform: scale(1.1);
      }
      
      body.dark-mode .theme-toggle:hover {
        background: rgba(255,255,255,0.1);
      }

      /* Sidebar styles */
      .sidebar {
        position: fixed;
        left: -280px;
        top: 0;
        width: 280px;
        height: 100vh;
        background: linear-gradient(
          135deg,
          var(--primary-color) 0%,
          var(--primary-light) 100%
        );
        transition: var(--transition-slow);
        z-index: 1000;
        box-shadow: var(--shadow-sm);
        overflow-y: auto;
      }
      
      body.dark-mode .sidebar {
        background: #2a2a2a;
      }

      .sidebar.open {
        left: 0;
      }

      .sidebar-header {
        padding: 20px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .sidebar-brand {
        color: white;
        font-size: 18px;
        font-weight: bold;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .sidebar-menu {
        padding: 20px 0;
      }

      .sidebar-item {
        display: block;
        color: white;
        text-decoration: none;
        padding: 15px 20px;
        transition: var(--transition-normal);
        border-left: 3px solid transparent;
      }

      .sidebar-item:hover,
      .sidebar-item.active {
        background: rgba(255, 255, 255, 0.1);
        border-left-color: white;
        color: white;
      }
      
      body.dark-mode .sidebar-item:hover,
      body.dark-mode .sidebar-item.active {
        background: rgba(76, 175, 80, 0.2);
        border-left-color: var(--primary-color);
        color: var(--primary-color);
      }

      .sidebar-item i {
        width: 20px;
        margin-right: 10px;
      }

      .sidebar-footer {
        position: absolute;
        bottom: 20px;
        width: 100%;
        padding: 0 20px;
      }

      .user-info {
        display: flex;
        align-items: center;
        gap: 10px;
        color: white;
        background: rgba(255, 255, 255, 0.1);
        padding: 15px;
        border-radius: var(--border-radius-sm);
        transition: var(--transition-normal);
      }

      .user-info:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: translateY(-1px);
      }

      .user-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: var(--primary-color);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      }

      /* Main content styles */
      .main-content {
        margin-left: 0;
        transition: var(--transition-slow);
        min-height: 100vh;
        background: var(--background-gradient);
      }
      
      body.dark-mode .main-content {
        background: var(--background-color);
      }

      .main-content.shifted {
        margin-left: 280px;
      }

      .top-nav {
        background: var(--card-background);
        padding: 15px 30px;
        box-shadow: var(--shadow-sm);
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: sticky;
        top: 0;
        z-index: 100;
      }

      .nav-left {
        display: flex;
        align-items: center;
        gap: 20px;
      }
      
      .nav-right {
        display: flex;
        align-items: center;
      }

      .menu-toggle {
        background: none;
        border: none;
        font-size: 20px;
        color: var(--text-medium);
        cursor: pointer;
        padding: 8px;
        border-radius: 5px;
        transition: var(--transition-normal);
      }

      .menu-toggle:hover {
        background: rgba(0,0,0,0.05);
      }
      
      body.dark-mode .menu-toggle:hover {
        background: rgba(255,255,255,0.1);
      }

      .page-title {
        font-size: 24px;
        font-weight: bold;
        color: var(--text-dark);
      }

      .search-container {
        position: relative;
        display: flex;
        align-items: center;
      }

      .search-bar-resources {
        display: flex;
        align-items: center;
        gap: 10px;
        background: var(--primary-lighter);
        border-radius: 25px;
        padding: 7px 14px;
        border: 1.5px solid #aed581;
        width: 280px;
        transition: var(--transition-normal);
      }
      
      body.dark-mode .search-bar-resources {
        background: #333;
        border-color: #444;
      }

      .search-bar-resources:focus-within {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
      }

      .search-bar-resources input {
        border: none;
        background: transparent;
        outline: none;
        padding: 7px 3px;
        font-size: 1rem;
        width: 100%;
        color: var(--text-dark);
      }

      .search-bar-resources input::placeholder {
        color: var(--text-light);
        opacity: 0.7;
      }

      .clear-search {
        cursor: pointer;
        color: #999;
        transition: var(--transition-normal);
        font-size: 14px;
        display: none;
      }

      .clear-search:hover {
        color: var(--text-dark);
      }

      .clear-search.visible {
        display: block;
      }

      /* Resources content */
      .resources-content {
        padding: 30px;
        max-width: 1400px;
        margin: 0 auto;
      }

      .resources-header-bar {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        justify-content: space-between;
        gap: 20px;
        margin-bottom: 25px;
      }

      .resources-title {
        font-size: 2rem;
        font-weight: bold;
        color: var(--text-dark);
        margin-bottom: 0;
      }

      .resources-controls {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        align-items: center;
      }

      .resource-filters {
        display: flex;
        align-items: center;
        flex-wrap: wrap;
        gap: 8px;
        margin: 0;
      }

      .resource-filter-btn {
        border: none;
        border-radius: var(--border-radius-sm);
        padding: 7px 16px;
        background: #f0f8f0;
        color: var(--primary-dark);
        font-weight: 500;
        font-size: 0.95rem;
        transition: var(--transition-normal);
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 6px;
      }
      
      body.dark-mode .resource-filter-btn {
        background: #333;
        color: var(--primary-color);
      }

      .resource-filter-btn.active,
      .resource-filter-btn:hover {
        background: var(--primary-dark);
        color: #fff;
      }

      .view-toggle {
        display: flex;
        align-items: center;
        background: #f0f8f0;
        border-radius: var(--border-radius-sm);
        overflow: hidden;
      }
      
      body.dark-mode .view-toggle {
        background: #333;
      }

      .view-toggle-btn {
        border: none;
        background: transparent;
        padding: 7px 12px;
        cursor: pointer;
        color: var(--text-medium);
        transition: var(--transition-normal);
      }

      .view-toggle-btn.active {
        background: var(--primary-dark);
        color: white;
      }

      .upload-btn {
        background: var(--primary-color);
        color: #fff;
        padding: 9px 22px;
        border-radius: 22px;
        font-weight: 500;
        border: none;
        font-size: 1rem;
        transition: var(--transition-normal);
        display: flex;
        align-items: center;
        gap: 7px;
      }

      .upload-btn:hover {
        background: var(--primary-darker);
        transform: translateY(-2px);
      }

      .upload-btn:active {
        transform: translateY(0);
      }

      .sort-dropdown {
        background: var(--card-background);
        border: 1px solid var(--border-color);
        border-radius: var(--border-radius-sm);
        padding: 7px 15px;
        font-size: 0.95rem;
        color: var(--text-dark);
        cursor: pointer;
        transition: var(--transition-normal);
        min-width: 140px;
      }

      .sort-dropdown:focus {
        border-color: var(--primary-color);
        outline: none;
        box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
      }

      /* Resource grid view */
      .resources-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(290px, 1fr));
        gap: 20px;
        margin-bottom: 40px;
        animation: fadeIn 0.5s ease-out;
      }

      .resource-card {
        background: var(--card-background);
        border-radius: var(--border-radius-md);
        box-shadow: var(--shadow-md);
        padding: 0 0 10px 0;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        min-height: 270px;
        position: relative;
        transition: var(--transition-normal);
        animation: scaleIn 0.3s ease-out;
      }

      .resource-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 20px rgba(76, 175, 80, 0.15);
      }
      
      body.dark-mode .resource-card:hover {
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
      }

      .resource-card-header {
        position: relative;
        overflow: hidden;
      }

      .resource-card-img {
        width: 100%;
        aspect-ratio: 16/9;
        object-fit: cover;
        border-radius: 14px 14px 0 0;
        height: 140px;
        background: #eee;
        display: block;
        transition: transform 0.3s ease;
      }
      
      body.dark-mode .resource-card-img {
        background: #333;
      }

      .resource-card:hover .resource-card-img {
        transform: scale(1.05);
      }

      .resource-type-badge {
        position: absolute;
        top: 10px;
        left: 10px;
        background: rgba(0, 0, 0, 0.6);
        color: white;
        padding: 4px 10px;
        border-radius: 4px;
        font-size: 12px;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 4px;
      }

      .resource-actions {
        position: absolute;
        top: 10px;
        right: 10px;
        display: flex;
        gap: 5px;
      }

      .resource-action-btn {
        background: rgba(255, 255, 255, 0.8);
        color: var(--primary-dark);
        border: none;
        width: 32px;
        height: 32px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: var(--transition-normal);
      }
      
      body.dark-mode .resource-action-btn {
        background: rgba(42, 42, 42, 0.8);
      }

      .resource-action-btn:hover {
        background: white;
        color: var(--primary-darker);
      }
      
      body.dark-mode .resource-action-btn:hover {
        background: #333;
      }

      .resource-card-body {
        padding: 16px;
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .resource-card-title {
        font-weight: bold;
        font-size: 1.13rem;
        margin-bottom: 0;
        color: var(--primary-dark);
      }

      .resource-card-tags {
        display: flex;
        gap: 7px;
        flex-wrap: wrap;
        margin-bottom: 7px;
      }

      .resource-card-tag {
        background: var(--primary-lighter);
        color: var(--primary-dark);
        border-radius: 16px;
        font-size: 0.85rem;
        padding: 3px 12px;
        font-weight: 500;
        transition: var(--transition-normal);
      }

      .resource-card-tag:hover {
        background: #d0ecd5;
      }
      
      body.dark-mode .resource-card-tag:hover {
        background: #374738;
      }

      .resource-card-desc {
        font-size: 0.97rem;
        color: var(--text-medium);
        margin-bottom: auto;
        line-height: 1.5;
      }

      .resource-card-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-top: 10px;
        border-top: 1px solid var(--border-color);
        margin-top: 5px;
      }

      .resource-card-by {
        font-size: 0.92rem;
        color: var(--text-light);
        display: flex;
        align-items: center;
        gap: 5px;
      }

      .resource-card-date {
        font-size: 0.92rem;
        color: var(--accent-color);
        font-weight: 500;
      }

      .resource-stats {
        display: flex;
        gap: 15px;
        color: var(--text-light);
        font-size: 0.9rem;
      }

      .resource-stat {
        display: flex;
        align-items: center;
        gap: 5px;
      }

      .resource-download-btn {
        color: var(--primary-dark);
        background: var(--primary-lighter);
        border: none;
        padding: 7px 15px;
        border-radius: var(--border-radius-sm);
        font-size: 0.9rem;
        font-weight: 500;
        cursor: pointer;
        transition: var(--transition-normal);
        display: flex;
        align-items: center;
        gap: 5px;
        text-decoration: none;
        margin-top: 10px;
        align-self: flex-end;
      }

      .resource-download-btn:hover {
        background: #c8efd2;
        color: var(--primary-darker);
      }
      
      body.dark-mode .resource-download-btn:hover {
        background: #374738;
      }

      /* Resource list view */
      .resources-list {
        background: var(--card-background);
        border-radius: var(--border-radius-md);
        box-shadow: var(--shadow-md);
        overflow: hidden;
        margin-bottom: 40px;
        animation: fadeIn 0.5s ease-out;
      }

      .resource-list-item {
        display: flex;
        padding: 15px 20px;
        border-bottom: 1px solid var(--border-color);
        transition: var(--transition-normal);
        align-items: center;
      }

      .resource-list-item:hover {
        background: #f9fcf9;
      }
      
      body.dark-mode .resource-list-item:hover {
        background: #333;
      }

      .resource-list-item:last-child {
        border-bottom: none;
      }

      .resource-list-icon {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--primary-lighter);
        color: var(--primary-dark);
        border-radius: var(--border-radius-sm);
        margin-right: 15px;
        flex-shrink: 0;
      }

      .resource-list-info {
        flex: 1;
      }

      .resource-list-title {
        font-weight: 600;
        color: var(--primary-dark);
        margin-bottom: 3px;
      }

      .resource-list-meta {
        display: flex;
        gap: 15px;
        color: var(--text-light);
        font-size: 0.9rem;
      }

      .resource-list-tags {
        margin-top: 5px;
        display: flex;
        gap: 5px;
      }

      .resource-list-tag {
        background: var(--primary-lighter);
        color: var(--primary-dark);
        border-radius: 12px;
        font-size: 0.8rem;
        padding: 2px 8px;
      }

      .resource-list-actions {
        display: flex;
        gap: 10px;
      }

      .resource-list-btn {
        background: none;
        border: none;
        color: var(--text-medium);
        cursor: pointer;
        width: 34px;
        height: 34px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: var(--transition-normal);
      }

      .resource-list-btn:hover {
        background: var(--primary-lighter);
        color: var(--primary-dark);
      }

      /* Files table */
      .resources-table-section {
        background: var(--card-background);
        border-radius: var(--border-radius-md);
        box-shadow: var(--shadow-md);
        padding: 25px 20px;
        margin-top: 30px;
        animation: fadeIn 0.5s ease-out;
      }

      .table-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
      }

      .table-title {
        font-weight: bold;
        color: var(--text-dark);
        font-size: 1.2rem;
        margin: 0;
      }

      .table-actions {
        display: flex;
        gap: 15px;
        align-items: center;
      }

      .resources-table {
        width: 100%;
        font-size: 0.95rem;
        margin: 0;
        color: var(--text-dark);
      }

      .resources-table thead {
        background: #f0f8f0;
        color: var(--primary-dark);
      }
      
      body.dark-mode .resources-table thead {
        background: #333;
      }

      .resources-table th {
        font-weight: 600;
        padding: 12px;
        border-bottom: 2px solid var(--border-color);
      }

      .resources-table th,
      .resources-table td {
        padding: 12px;
        text-align: left;
        vertical-align: middle;
      }

      .resources-table tbody tr {
        transition: var(--transition-normal);
        border-bottom: 1px solid var(--border-color);
      }

      .resources-table tbody tr:hover {
        background: #f3fef3;
      }
      
      body.dark-mode .resources-table tbody tr:hover {
        background: #333;
      }

      .resources-table tbody tr:last-child {
        border-bottom: none;
      }

      .file-type-cell {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .file-icon {
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 6px;
        color: white;
        font-size: 0.8rem;
        font-weight: 500;
      }

      .file-icon.pdf {
        background: #f44336;
      }
      .file-icon.docx {
        background: #2196f3;
      }
      .file-icon.ppt {
        background: #ff9800;
      }

      .download-btn {
        color: var(--primary-dark);
        background: none;
        border: none;
        font-size: 1.1rem;
        cursor: pointer;
        padding: 6px;
        border-radius: 50%;
        transition: var(--transition-normal);
        width: 34px;
        height: 34px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .download-btn:hover {
        background: var(--primary-lighter);
        color: var(--primary-darker);
      }

      /* Empty state */
      .empty-state {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 60px 20px;
        text-align: center;
        background: var(--card-background);
        border-radius: var(--border-radius-md);
        box-shadow: var(--shadow-md);
      }

      .empty-state-icon {
        font-size: 60px;
        color: #ccc;
        margin-bottom: 20px;
      }
      
      body.dark-mode .empty-state-icon {
        color: #555;
      }

      .empty-state-text {
        font-size: 1.2rem;
        color: var(--text-light);
        margin-bottom: 30px;
      }

      /* Upload modal */
      .modal-content {
        border-radius: var(--border-radius-md);
        border: none;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        background: var(--card-background);
        color: var(--text-dark);
      }

      .modal-header {
        border-bottom: 1px solid var(--border-color);
        padding: 20px 25px;
      }

      .modal-title {
        color: var(--primary-dark);
        font-weight: bold;
      }

      .modal-body {
        padding: 25px;
      }

      .modal-footer {
        padding: 15px 25px;
        border-top: 1px solid var(--border-color);
      }

      .file-input-container {
        position: relative;
        background: #f9f9f9;
        border: 2px dashed #ddd;
        border-radius: var(--border-radius-md);
        padding: 30px 20px;
        text-align: center;
        margin-bottom: 20px;
        transition: var(--transition-normal);
        cursor: pointer;
      }
      
      body.dark-mode .file-input-container {
        background: #333;
        border-color: #444;
      }

      .file-input-container:hover {
        border-color: var(--primary-color);
        background: #f5f9f5;
      }
      
      body.dark-mode .file-input-container:hover {
        background: #3a3a3a;
      }

      .file-input-container input {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        cursor: pointer;
      }

      .file-input-icon {
        font-size: 40px;
        color: var(--primary-color);
        margin-bottom: 15px;
      }

      .file-input-text {
        color: var(--text-medium);
        font-size: 1rem;
      }

      .file-input-hint {
        color: var(--text-light);
        font-size: 0.9rem;
        margin-top: 5px;
      }

      .file-preview {
        display: flex;
        align-items: center;
        gap: 15px;
        background: var(--primary-lighter);
        border-radius: var(--border-radius-sm);
        padding: 12px 15px;
        margin-bottom: 20px;
      }

      .file-preview-icon {
        font-size: 24px;
        color: var(--primary-dark);
      }

      .file-preview-name {
        font-weight: 500;
        color: var(--text-dark);
        flex: 1;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .file-preview-remove {
        color: #f44336;
        cursor: pointer;
        font-size: 18px;
        padding: 5px;
        border-radius: 50%;
        transition: var(--transition-normal);
      }

      .file-preview-remove:hover {
        background: #fee8e7;
      }
      
      body.dark-mode .file-preview-remove:hover {
        background: #4d2827;
      }

      .form-label {
        color: var(--text-dark);
        font-weight: 500;
        margin-bottom: 8px;
      }

      .form-text {
        color: var(--text-light);
        font-size: 0.85rem;
        margin-top: 5px;
      }

      .form-control {
        background-color: var(--card-background);
        border-color: var(--border-color);
        color: var(--text-dark);
      }
      
      .form-control:focus {
        background-color: var(--card-background);
        color: var(--text-dark);
        border-color: var(--primary-color);
        box-shadow: 0 0 0 0.2rem rgba(76, 175, 80, 0.25);
      }

      .tag-selector {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-top: 10px;
      }

      .tag-option {
        padding: 6px 14px;
        background: #f5f5f5;
        border-radius: 20px;
        font-size: 0.9rem;
        color: var(--text-medium);
        cursor: pointer;
        transition: var(--transition-normal);
      }
      
      body.dark-mode .tag-option {
        background: #333;
      }

      .tag-option:hover {
        background: #e8e8e8;
      }
      
      body.dark-mode .tag-option:hover {
        background: #444;
      }

      .tag-option.selected {
        background: var(--primary-lighter);
        color: var(--primary-dark);
      }
      
      body.dark-mode .tag-option.selected {
        background: #2c3b2d;
      }

      /* Cover image preview */
      .cover-preview {
        max-width: 100%;
        height: auto;
        max-height: 150px;
        margin-top: 10px;
        border-radius: var(--border-radius-sm);
        display: none;
      }

      /* Toast notifications */
      .toast-container {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 1050;
        display: flex;
        flex-direction: column;
        gap: 10px;
        pointer-events: none;
      }

      .toast {
        padding: 15px 20px;
        border-radius: var(--border-radius-sm);
        background: var(--card-background);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        display: flex;
        align-items: center;
        gap: 15px;
        width: 300px;
        max-width: 90vw;
        animation: slideIn 0.3s ease-out;
        pointer-events: auto;
      }

      .toast.success {
        border-left: 4px solid var(--primary-color);
      }

      .toast.error {
        border-left: 4px solid #f44336;
      }

      .toast-icon {
        font-size: 24px;
      }

      .toast-icon.success {
        color: var(--primary-color);
      }

      .toast-icon.error {
        color: #f44336;
      }

      .toast-content {
        flex: 1;
      }

      .toast-title {
        font-weight: 600;
        color: var(--text-dark);
        margin-bottom: 3px;
      }

      .toast-message {
        color: var(--text-medium);
        font-size: 0.9rem;
      }

      .toast-close {
        color: var(--text-light);
        background: none;
        border: none;
        font-size: 20px;
        cursor: pointer;
        padding: 5px;
      }

      /* Lazy loading */
      .lazy-image {
        opacity: 0;
        transition: opacity 0.3s;
      }

      .lazy-image.loaded {
        opacity: 1;
      }

      /* Responsive design */
      @media (max-width: 1200px) {
        .resources-content {
          padding: 25px 20px;
        }
      }

      @media (max-width: 992px) {
        .resources-grid {
          grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
        }

        .resources-header-bar {
          flex-direction: column;
          align-items: flex-start;
        }

        .resources-controls {
          width: 100%;
          justify-content: space-between;
        }

        .search-bar-resources {
          width: 100%;
          max-width: none;
        }
      }

      @media (max-width: 768px) {
        .main-content.shifted {
          margin-left: 0;
        }
        .resources-content {
          padding: 15px;
        }
        .top-nav {
          padding: 12px 15px;
        }

        .resource-list-item {
          flex-wrap: wrap;
          padding: 15px;
        }

        .resource-list-info {
          width: 100%;
          margin-bottom: 10px;
        }

        .resource-list-meta {
          flex-wrap: wrap;
          gap: 10px;
        }

        .resource-list-actions {
          margin-left: auto;
        }

        .resources-table-section {
          padding: 15px;
        }

        .resources-table thead {
          display: none;
        }

        .resources-table tbody,
        .resources-table tr,
        .resources-table td {
          display: block;
          width: 100%;
        }

        .resources-table tr {
          margin-bottom: 15px;
          border-bottom: 1px solid var(--border-color);
          position: relative;
        }

        .resources-table td {
          text-align: right;
          padding: 8px 10px;
          position: relative;
          padding-left: 50%;
        }

        .resources-table td:before {
          content: attr(data-label);
          position: absolute;
          left: 10px;
          width: 45%;
          text-align: left;
          font-weight: 600;
        }
      }

      @media (max-width: 576px) {
        .resources-grid {
          grid-template-columns: 1fr;
        }

        .resource-filters {
          width: 100%;
          justify-content: space-between;
        }

        .resource-filter-btn {
          flex: 1;
          text-align: center;
          padding: 6px 5px;
          font-size: 0.85rem;
        }

        .upload-btn {
          width: 100%;
          justify-content: center;
        }

        .resource-card-tags {
          flex-wrap: nowrap;
          overflow-x: auto;
          padding-bottom: 5px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-brand">
          <i class="bi bi-book"></i>
          StudyGroup
        </div>
      </div>
      <nav class="sidebar-menu">
        <a href="dashboard.html" class="sidebar-item">
          <i class="bi bi-house"></i>
          Dashboard
        </a>
        <a href="profile.html" class="sidebar-item">
          <i class="bi bi-person"></i>
          Profile
        </a>
        <a href="study-rooms.html" class="sidebar-item">
          <i class="bi bi-door-open"></i>
          Study Rooms
        </a>
        <a href="resources.html" class="sidebar-item active">
          <i class="bi bi-folder"></i>
          Resources
        </a>
        <a href="discussion.html" class="sidebar-item">
          <i class="bi bi-chat-dots"></i>
          Discussion Forum
        </a>
        <a href="report.html" class="sidebar-item">
          <i class="bi bi-graph-up"></i>
          Report
        </a>
      </nav>
      <div class="sidebar-footer">
        <div
          class="user-info"
          onclick="goToProfile()"
          style="cursor: pointer; transition: all 0.3s ease"
        >
          <div class="user-avatar" id="userAvatar">DP</div>
          <div>
            <div style="font-weight: bold; font-size: 14px" id="userName">
              DanePascual
            </div>
            <div style="font-size: 12px; opacity: 0.8">BSIT</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <div class="main-content" id="mainContent">
      <!-- Top Navigation -->
      <div class="top-nav">
        <div class="nav-left">
          <button
            class="menu-toggle"
            id="menuToggle"
            aria-label="Toggle sidebar"
          >
            <i class="bi bi-list"></i>
          </button>
          <h1 class="page-title">Resources</h1>
        </div>
        <div class="nav-right">
          <button class="theme-toggle" id="themeToggle" title="Toggle theme">
            <i class="bi bi-moon"></i>
          </button>
          <div class="search-container">
            <form
              class="search-bar-resources"
              style="margin-bottom: 0"
              onsubmit="event.preventDefault();"
            >
              <i class="bi bi-search"></i>
              <input
                type="text"
                id="resourceSearch"
                placeholder="Search for resources..."
                autocomplete="off"
                aria-label="Search resources"
              />
              <i
                class="bi bi-x clear-search"
                id="clearSearch"
                aria-label="Clear search"
              ></i>
            </form>
          </div>
        </div>
      </div>

      <!-- Resources Content -->
      <div class="resources-content">
        <div class="resources-header-bar">
          <div
            class="resource-filters"
            role="group"
            aria-label="Filter resources"
          >
            <button
              class="resource-filter-btn active"
              data-type="all"
              onclick="filterResources(event)"
            >
              <i class="bi bi-grid-3x3-gap-fill"></i> All
            </button>
            <button
              class="resource-filter-btn"
              data-type="docx"
              onclick="filterResources(event)"
            >
              <i class="bi bi-file-earmark-word"></i> Documents
            </button>
            <button
              class="resource-filter-btn"
              data-type="pdf"
              onclick="filterResources(event)"
            >
              <i class="bi bi-file-earmark-pdf"></i> PDF
            </button>
            <button
              class="resource-filter-btn"
              data-type="ppt"
              onclick="filterResources(event)"
            >
              <i class="bi bi-file-earmark-slides"></i> PPT
            </button>
          </div>

          <div class="resources-controls">
            <div class="view-toggle" role="group" aria-label="Change view">
              <button
                class="view-toggle-btn active"
                id="gridViewBtn"
                aria-label="Grid view"
                title="Grid view"
              >
                <i class="bi bi-grid-3x3-gap"></i>
              </button>
              <button
                class="view-toggle-btn"
                id="listViewBtn"
                aria-label="List view"
                title="List view"
              >
                <i class="bi bi-list-ul"></i>
              </button>
            </div>

            <select
              class="sort-dropdown"
              id="sortDropdown"
              aria-label="Sort resources"
            >
              <option value="newest">Newest first</option>
              <option value="oldest">Oldest first</option>
              <option value="name-asc">Name (A-Z)</option>
              <option value="name-desc">Name (Z-A)</option>
              <option value="popular">Most downloads</option>
            </select>

            <button
              class="upload-btn"
              onclick="openUploadModal()"
              aria-label="Upload resources"
            >
              <i class="bi bi-upload"></i> Upload
            </button>
          </div>
        </div>

        <!-- Resource Grid View (default) -->
        <div class="resources-grid" id="resourcesGrid">
          <!-- Will be populated by JavaScript -->
          <div class="skeleton-loader"></div>
        </div>

        <!-- Resource List View (hidden by default) -->
        <div class="resources-list" id="resourcesList" style="display: none">
          <!-- Will be populated by JavaScript -->
        </div>

        <!-- Recent Uploads Section -->
        <div class="resources-table-section">
          <div class="table-header">
            <h2 class="table-title">Recent Uploads</h2>
            <div class="table-actions">
              <select
                class="sort-dropdown"
                id="tableSort"
                aria-label="Sort table"
              >
                <option value="newest">Newest first</option>
                <option value="name-asc">Name (A-Z)</option>
                <option value="size">Size</option>
              </select>
            </div>
          </div>

          <div class="table-responsive">
            <table class="resources-table" aria-label="Recent uploads">
              <thead>
                <tr>
                  <th scope="col">Name</th>
                  <th scope="col">Uploaded By</th>
                  <th scope="col">Date</th>
                  <th scope="col">Type</th>
                  <th scope="col">Size</th>
                  <th scope="col">Actions</th>
                </tr>
              </thead>
              <tbody id="resourcesTable">
                <!-- Will be populated by JavaScript -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Upload Modal -->
    <div
      class="modal fade"
      id="uploadModal"
      tabindex="-1"
      aria-labelledby="uploadModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
          <form id="uploadForm">
            <div class="modal-header">
              <h5 class="modal-title" id="uploadModalLabel">Upload Resource</h5>
              <button
                type="button"
                class="btn-close"
                onclick="closeUploadModal()"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">
              <div id="fileDropArea" class="file-input-container">
                <div class="file-input-icon">
                  <i class="bi bi-cloud-arrow-up"></i>
                </div>
                <div class="file-input-text">Drag and drop your file here</div>
                <div class="file-input-hint">or click to browse</div>
                <input
                  type="file"
                  class="form-control"
                  id="fileInput"
                  accept=".pdf,.doc,.docx,.ppt,.pptx"
                  required
                />
              </div>

              <div id="filePreview" style="display: none" class="file-preview">
                <div class="file-preview-icon">
                  <i class="bi bi-file-earmark"></i>
                </div>
                <div class="file-preview-name" id="selectedFileName"></div>
                <div class="file-preview-remove" onclick="removeSelectedFile()">
                  <i class="bi bi-x"></i>
                </div>
              </div>

              <div class="mb-3">
                <label for="resourceTitle" class="form-label">Title</label>
                <input
                  type="text"
                  class="form-control"
                  id="resourceTitle"
                  required
                />
                <div class="form-text">
                  Give your resource a descriptive title
                </div>
              </div>

              <div class="mb-3">
                <label class="form-label">Category</label>
                <select class="form-control" id="resourceCategory" required>
                  <option value="">Select a category</option>
                  <option value="lecture">Lecture Notes</option>
                  <option value="assignment">Assignments & Solutions</option>
                  <option value="tutorial">Tutorials</option>
                  <option value="exam">Exam Preparation</option>
                  <option value="reference">Reference Materials</option>
                  <option value="other">Other</option>
                </select>
              </div>

              <div class="mb-3">
                <label class="form-label">Tags</label>
                <div class="tag-selector" id="tagSelector">
                  <div class="tag-option" data-tag="math">Mathematics</div>
                  <div class="tag-option" data-tag="programming">
                    Programming
                  </div>
                  <div class="tag-option" data-tag="science">Science</div>
                  <div class="tag-option" data-tag="engineering">
                    Engineering
                  </div>
                  <div class="tag-option" data-tag="humanities">Humanities</div>
                  <div class="tag-option" data-tag="language">Language</div>
                  <div class="tag-option" data-tag="business">Business</div>
                </div>
                <input type="hidden" id="selectedTags" value="" />
                <div class="form-text">Select up to 3 tags</div>
              </div>

              <div class="mb-3">
                <label for="resourceDesc" class="form-label">Description</label>
                <textarea
                  class="form-control"
                  id="resourceDesc"
                  rows="3"
                ></textarea>
                <div class="form-text">
                  Provide a brief description of what this resource contains
                </div>
              </div>

              <div class="mb-3">
                <label for="coverImageInput" class="form-label">Cover Image (optional)</label>
                <input
                  type="file"
                  class="form-control"
                  id="coverImageInput"
                  accept="image/*"
                />
                <div class="form-text">
                  Add a cover image to make your resource more visible
                </div>
                <img src="" id="coverImagePreview" class="cover-preview" alt="Cover image preview">
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-outline-secondary"
                onclick="closeUploadModal()"
              >
                Cancel
              </button>
              <button type="submit" class="btn btn-success">
                <i class="bi bi-cloud-upload"></i> Upload Resource
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Toast Notifications Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script>
      // Current user information
      const currentUser = {
        id: "user_dane_pascual",
        name: "DanePascual",
        initials: "DP",
        role: "BSIT Student",
      };
      
      // Current session information
      const CURRENT_SESSION = {
        utcTime: "2025-07-11 17:47:54", // UTC time
        user: "DanePascual",
        timezone: "UTC"
      };

      // Theme management
      function initializeTheme() {
        const themeToggle = document.getElementById('themeToggle');
        const body = document.body;
        
        // Load saved theme from localStorage
        const savedTheme = localStorage.getItem('theme') || 'light';
        if (savedTheme === 'dark') {
          body.classList.add('dark-mode');
          themeToggle.innerHTML = '<i class="bi bi-sun"></i>';
        }
        
        // Add toggle event
        themeToggle.addEventListener('click', () => {
          body.classList.toggle('dark-mode');
          const isDark = body.classList.contains('dark-mode');
          themeToggle.innerHTML = isDark ? '<i class="bi bi-sun"></i>' : '<i class="bi bi-moon"></i>';
          localStorage.setItem('theme', isDark ? 'dark' : 'light');
        });
      }

      // File type configuration
      const fileTypes = {
        pdf: {
          icon: "bi-file-earmark-pdf",
          color: "#f44336",
          image:
            "data:image/svg+xml;utf8,<svg width='70' height='70' xmlns='http://www.w3.org/2000/svg'><rect x='0' y='0' width='70' height='70' rx='12' ry='12' fill='%23f44336'/><text x='50%' y='55%' font-size='24' font-family='Arial' fill='white' text-anchor='middle' alignment-baseline='middle'>PDF</text></svg>",
        },
        docx: {
          icon: "bi-file-earmark-word",
          color: "#2196f3",
          image:
            "data:image/svg+xml;utf8,<svg width='70' height='70' xmlns='http://www.w3.org/2000/svg'><rect x='0' y='0' width='70' height='70' rx='12' ry='12' fill='%232196f3'/><text x='50%' y='55%' font-size='22' font-family='Arial' fill='white' text-anchor='middle' alignment-baseline='middle'>DOC</text></svg>",
        },
        doc: {
          icon: "bi-file-earmark-word",
          color: "#2196f3",
          image:
            "data:image/svg+xml;utf8,<svg width='70' height='70' xmlns='http://www.w3.org/2000/svg'><rect x='0' y='0' width='70' height='70' rx='12' ry='12' fill='%232196f3'/><text x='50%' y='55%' font-size='22' font-family='Arial' fill='white' text-anchor='middle' alignment-baseline='middle'>DOC</text></svg>",
        },
        ppt: {
          icon: "bi-file-earmark-slides",
          color: "#ff9800",
          image:
            "data:image/svg+xml;utf8,<svg width='70' height='70' xmlns='http://www.w3.org/2000/svg'><rect x='0' y='0' width='70' height='70' rx='12' ry='12' fill='%23ff9800'/><text x='50%' y='55%' font-size='22' font-family='Arial' fill='white' text-anchor='middle' alignment-baseline='middle'>PPT</text></svg>",
        },
        pptx: {
          icon: "bi-file-earmark-slides",
          color: "#ff9800",
          image:
            "data:image/svg+xml;utf8,<svg width='70' height='70' xmlns='http://www.w3.org/2000/svg'><rect x='0' y='0' width='70' height='70' rx='12' ry='12' fill='%23ff9800'/><text x='50%' y='55%' font-size='22' font-family='Arial' fill='white' text-anchor='middle' alignment-baseline='middle'>PPT</text></svg>",
        },
        default: {
          icon: "bi-file-earmark",
          color: "#607d8b",
          image:
            "data:image/svg+xml;utf8,<svg width='70' height='70' xmlns='http://www.w3.org/2000/svg'><rect x='0' y='0' width='70' height='70' rx='12' ry='12' fill='%23607d8b'/><text x='50%' y='55%' font-size='22' font-family='Arial' fill='white' text-anchor='middle' alignment-baseline='middle'>FILE</text></svg>",
        },
      };

      // Get file type details
      function getFileTypeInfo(filename) {
        if (!filename) return fileTypes.default;
        const extension = filename.split(".").pop().toLowerCase();
        return fileTypes[extension] || fileTypes.default;
      }

      // Function to get file icon based on type
      function getResourceImage(res) {
        if (res.coverImage) return res.coverImage;
        const typeKey = res.type.toLowerCase();
        return fileTypes[typeKey]?.image || fileTypes.default.image;
      }

      // Sample resources data
      // Load resources from localStorage or start with empty arrays
      let sampleResources = JSON.parse(
        localStorage.getItem("resources_data") || "[]"
      );
      let sampleFiles = JSON.parse(localStorage.getItem("files_data") || "[]");

      // Initialize with empty arrays if first time loading
      if (!localStorage.getItem("resources_data_initialized")) {
        // This flag ensures we don't re-initialize when the page reloads
        localStorage.setItem("resources_data_initialized", "true");
        localStorage.setItem("resources_data", JSON.stringify([]));
        localStorage.setItem("files_data", JSON.stringify([]));
      }

      // Store current state
      const state = {
        currentView: "grid", // 'grid' or 'list'
        currentType: "all", // 'all', 'pdf', 'docx', 'ppt'
        currentSort: "newest", // sorting method
        currentSearch: "", // search term
        tableSort: "newest", // table sorting method
        favorites: [], // IDs of favorited resources
      };

      // Load user data
      function loadUserData() {
        document.getElementById("userAvatar").textContent =
          currentUser.initials;
        document.getElementById("userName").textContent = currentUser.name;

        // Load favorites from localStorage
        try {
          const savedFavorites =
            JSON.parse(localStorage.getItem(`favorites_${currentUser.id}`)) ||
            [];
          state.favorites = savedFavorites;
        } catch (e) {
          console.error("Error loading favorites:", e);
          state.favorites = [];
        }
      }

      // Format date string to readable format
      function formatDate(dateString) {
        const date = new Date(dateString);
        const options = { year: "numeric", month: "short", day: "numeric" };
        return date.toLocaleDateString(undefined, options);
      }

      // Format relative time for recent uploads
      function formatRelativeTime(dateString) {
        const date = new Date(dateString);
        const now = new Date();
        const diffMs = now - date;
        const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));

        if (diffDays === 0) return "Today";
        if (diffDays === 1) return "Yesterday";
        if (diffDays < 7) return `${diffDays} days ago`;

        return formatDate(dateString);
      }

      // Render resources in grid view
      function renderResourcesGrid(filteredResources) {
        const grid = document.getElementById("resourcesGrid");
        grid.innerHTML = "";

        if (filteredResources.length === 0) {
          grid.innerHTML = `
      <div class="empty-state">
        <div class="empty-state-icon"><i class="bi bi-folder2-open"></i></div>
        <div class="empty-state-text">No resources found</div>
        <button class="upload-btn" onclick="openUploadModal()">
          <i class="bi bi-upload"></i> Upload a Resource
        </button>
      </div>
    `;
          return;
        }

        filteredResources.forEach((res) => {
          const isFavorited = state.favorites.includes(res.id);
          const isOwnResource = res.userId === currentUser.id;
          const typeInfo = getFileTypeInfo(res.title + "." + res.type);

          grid.innerHTML += `
      <div class="resource-card" data-id="${res.id}">
        <div class="resource-card-header">
          <img src="${getResourceImage(
            res
          )}" class="resource-card-img lazy-image" alt="" loading="lazy" />
          <div class="resource-type-badge">
            <i class="bi ${typeInfo.icon}"></i> ${res.type.toUpperCase()}
          </div>
          <div class="resource-actions">
            <button class="resource-action-btn favorite-btn ${
              isFavorited ? "active" : ""
            }" 
                    onclick="toggleFavorite('${res.id}')" aria-label="${
            isFavorited ? "Remove from favorites" : "Add to favorites"
          }">
              <i class="bi ${
                isFavorited ? "bi-bookmark-fill" : "bi-bookmark"
              }"></i>
            </button>
            ${
              isOwnResource
                ? `
                            <button class="resource-action-btn" onclick="editResource('${res.id}')" aria-label="Edit resource">
                <i class="bi bi-pencil"></i>
              </button>
              <button class="resource-action-btn" onclick="confirmDeleteResource('${res.id}')" aria-label="Delete resource">
                <i class="bi bi-trash"></i>
              </button>
            `
                : ""
            }
          </div>
        </div>
        <div class="resource-card-body">
          <h3 class="resource-card-title">${res.title}</h3>
          <div class="resource-card-tags">
            ${res.tags
              .map((tag) => `<span class="resource-card-tag">${tag}</span>`)
              .join("")}
          </div>
          <div class="resource-card-desc">${res.desc}</div>
          <div class="resource-stats">
            <div class="resource-stat"><i class="bi bi-download"></i> ${
              res.downloads
            }</div>
            <div class="resource-stat"><i class="bi bi-eye"></i> ${
              res.views
            }</div>
          </div>
          <a href="${
            res.url
          }" class="resource-download-btn" download title="Download">
            <i class="bi bi-download"></i> Download
          </a>
          <div class="resource-card-footer">
            <span class="resource-card-by">
              <i class="bi bi-person"></i> ${res.by}
            </span>
            <span class="resource-card-date">${formatRelativeTime(
              res.date
            )}</span>
          </div>
        </div>
      </div>
    `;
        });

        // Initialize lazy loading
        initLazyLoading();
      }

      // Render resources in list view
      function renderResourcesList(filteredResources) {
        const list = document.getElementById("resourcesList");
        list.innerHTML = "";

        if (filteredResources.length === 0) {
          list.innerHTML = `
        <div class="empty-state">
          <div class="empty-state-icon"><i class="bi bi-folder2-open"></i></div>
          <div class="empty-state-text">No resources found</div>
          <button class="upload-btn" onclick="openUploadModal()">
            <i class="bi bi-upload"></i> Upload a Resource
          </button>
        </div>
      `;
          return;
        }

        filteredResources.forEach((res) => {
          const isFavorited = state.favorites.includes(res.id);
          const isOwnResource = res.userId === currentUser.id;
          const typeInfo = getFileTypeInfo(res.title + "." + res.type);

          list.innerHTML += `
        <div class="resource-list-item" data-id="${res.id}">
          <div class="resource-list-icon">
            <i class="bi ${typeInfo.icon}"></i>
          </div>
          <div class="resource-list-info">
            <div class="resource-list-title">${res.title}</div>
            <div class="resource-list-meta">
              <span><i class="bi bi-person"></i> ${res.by}</span>
              <span><i class="bi bi-calendar3"></i> ${formatRelativeTime(
                res.date
              )}</span>
              <span><i class="bi bi-download"></i> ${
                res.downloads
              } downloads</span>
            </div>
            <div class="resource-list-tags">
              ${res.tags
                .slice(0, 3)
                .map((tag) => `<span class="resource-list-tag">${tag}</span>`)
                .join("")}
            </div>
          </div>
          <div class="resource-list-actions">
            <button class="resource-list-btn favorite-btn ${
              isFavorited ? "active" : ""
            }" 
                    onclick="toggleFavorite('${res.id}')" title="${
            isFavorited ? "Remove from favorites" : "Add to favorites"
          }">
              <i class="bi ${
                isFavorited ? "bi-bookmark-fill" : "bi-bookmark"
              }"></i>
            </button>
            <a href="${
              res.url
            }" class="resource-list-btn" download title="Download">
              <i class="bi bi-download"></i>
            </a>
            ${
              isOwnResource
                ? `
              <button class="resource-list-btn" onclick="editResource('${res.id}')" title="Edit resource">
                <i class="bi bi-pencil"></i>
              </button>
              <button class="resource-list-btn" onclick="confirmDeleteResource('${res.id}')" title="Delete resource">
                <i class="bi bi-trash"></i>
              </button>
            `
                : ""
            }
          </div>
        </div>
      `;
        });
      }

      // Render files table
      function renderFilesTable(sort = state.tableSort) {
        const tbody = document.getElementById("resourcesTable");
        tbody.innerHTML = "";

        // Create a copy of files and sort
        let files = [...sampleFiles];

        switch (sort) {
          case "newest":
            files.sort((a, b) => new Date(b.date) - new Date(a.date));
            break;
          case "name-asc":
            files.sort((a, b) => a.name.localeCompare(b.name));
            break;
          case "size":
            files.sort((a, b) => {
              const sizeA = parseFloat(a.size);
              const sizeB = parseFloat(b.size);
              return sizeB - sizeA;
            });
            break;
        }

        if (files.length === 0) {
          tbody.innerHTML = `<tr><td colspan="6" class="text-center text-muted">No files found</td></tr>`;
          return;
        }

        files.forEach((file, index) => {
          const fileTypeInfo = getFileTypeInfo(file.name);
          const fileType = file.type.toLowerCase();
          const isOwnFile = file.userId === currentUser.id;

          tbody.innerHTML += `
        <tr data-id="${file.id}">
          <td data-label="Name" class="file-type-cell">
            <div class="file-icon ${fileType}" style="background-color:${
            fileTypeInfo.color
          }">${file.type}</div>
            ${file.name}
          </td>
          <td data-label="Uploaded By">${file.by}</td>
          <td data-label="Date">${formatRelativeTime(file.date)}</td>
          <td data-label="Type">${file.type}</td>
          <td data-label="Size">${file.size}</td>
          <td data-label="Actions">
            <div class="d-flex gap-2">
              <a href="${
                file.url
              }" class="download-btn" download title="Download">
                <i class="bi bi-download"></i>
              </a>
              ${
                isOwnFile
                  ? `
                <button class="download-btn" onclick="confirmDeleteFile('${file.id}')" title="Delete file">
                  <i class="bi bi-trash"></i>
                </button>
              `
                  : ""
              }
            </div>
          </td>
        </tr>
      `;
        });
      }

      // Filter resources based on type and search term
      function filterResources(e) {
        if (e) {
          document.querySelectorAll(".resource-filter-btn").forEach((btn) => {
            btn.classList.remove("active");
          });
          e.target.classList.add("active");
          state.currentType = e.target.getAttribute("data-type");
        }

        applyFiltersAndSort();
      }

      // Apply current filters and sorting
      function applyFiltersAndSort() {
        const searchTerm = state.currentSearch.toLowerCase();

        // Filter resources
        let filtered = sampleResources.filter((res) => {
          const matchType =
            state.currentType === "all" ? true : res.type === state.currentType;
          const matchSearch =
            searchTerm.length === 0 ||
            res.title.toLowerCase().includes(searchTerm) ||
            res.desc.toLowerCase().includes(searchTerm) ||
            res.tags.some((tag) => tag.toLowerCase().includes(searchTerm));

          return matchType && matchSearch;
        });

        // Apply sorting
        switch (state.currentSort) {
          case "newest":
            filtered.sort((a, b) => new Date(b.date) - new Date(a.date));
            break;
          case "oldest":
            filtered.sort((a, b) => new Date(a.date) - new Date(b.date));
            break;
          case "name-asc":
            filtered.sort((a, b) => a.title.localeCompare(b.title));
            break;
          case "name-desc":
            filtered.sort((a, b) => b.title.localeCompare(a.title));
            break;
          case "popular":
            filtered.sort((a, b) => b.downloads - a.downloads);
            break;
        }

        // Update the view based on current view mode
        if (state.currentView === "grid") {
          document.getElementById("resourcesGrid").style.display = "grid";
          document.getElementById("resourcesList").style.display = "none";
          renderResourcesGrid(filtered);
        } else {
          document.getElementById("resourcesGrid").style.display = "none";
          document.getElementById("resourcesList").style.display = "block";
          renderResourcesList(filtered);
        }
      }

      // Toggle between grid and list view
      function setViewMode(mode) {
        const gridBtn = document.getElementById("gridViewBtn");
        const listBtn = document.getElementById("listViewBtn");

        if (mode === "grid") {
          gridBtn.classList.add("active");
          listBtn.classList.remove("active");
          state.currentView = "grid";
        } else {
          gridBtn.classList.remove("active");
          listBtn.classList.add("active");
          state.currentView = "list";
        }

        applyFiltersAndSort();
      }

      // Toggle favorite status for a resource
      function toggleFavorite(resourceId) {
        const index = state.favorites.indexOf(resourceId);

        if (index === -1) {
          // Add to favorites
          state.favorites.push(resourceId);
          showToast("Resource added to favorites", "success");
        } else {
          // Remove from favorites
          state.favorites.splice(index, 1);
          showToast("Resource removed from favorites", "success");
        }

        // Save to localStorage
        localStorage.setItem(
          `favorites_${currentUser.id}`,
          JSON.stringify(state.favorites)
        );

        // Update UI
        applyFiltersAndSort();
      }

      // Edit resource
      function editResource(resourceId) {
        const resource = sampleResources.find((r) => r.id === resourceId);
        if (!resource) return;

        openUploadModal();

        // Fill form with resource data
        document.getElementById("resourceTitle").value = resource.title;
        document.getElementById("resourceDesc").value = resource.desc;

        // Select tags
        document.querySelectorAll(".tag-option").forEach((tagOption) => {
          const tag = tagOption.getAttribute("data-tag");
          if (
            resource.tags
              .map((t) => t.toLowerCase())
              .includes(tag.toLowerCase())
          ) {
            tagOption.classList.add("selected");
          }
        });

        // Store that we're editing
        document
          .querySelector("#uploadForm")
          .setAttribute("data-edit-id", resourceId);
        document.querySelector("#uploadModalLabel").textContent =
          "Edit Resource";

        // Show file preview
        document.getElementById("filePreview").style.display = "flex";
        document.getElementById("selectedFileName").textContent =
          resource.title + "." + resource.type;
        document.getElementById("fileDropArea").style.display = "none";

        // Set category if it exists
        if (resource.category) {
          const categorySelect = document.getElementById("resourceCategory");
          for (let i = 0; i < categorySelect.options.length; i++) {
            if (categorySelect.options[i].value === resource.category) {
              categorySelect.selectedIndex = i;
              break;
            }
          }
        }

        // Show cover image if it exists
        if (resource.coverImage) {
          document.getElementById("coverImagePreview").src = resource.coverImage;
          document.getElementById("coverImagePreview").style.display = "block";
        }
      }

      // Confirm delete resource
      function confirmDeleteResource(resourceId) {
        if (
          confirm(
            "Are you sure you want to delete this resource? This action cannot be undone."
          )
        ) {
          deleteResource(resourceId);
        }
      }

      // Delete resource
      function deleteResource(resourceId) {
        // Find the resource index
        const index = sampleResources.findIndex((r) => r.id === resourceId);
        if (index === -1) return;

        // Only allow deleting own resources
        if (sampleResources[index].userId !== currentUser.id) {
          showToast("You can only delete your own resources", "error");
          return;
        }

        // Remove from array
        sampleResources.splice(index, 1);

        // Save to localStorage after deletion
        localStorage.setItem("resources_data", JSON.stringify(sampleResources));

        // Also check if it exists in files table
        const fileIndex = sampleFiles.findIndex((f) => f.id === resourceId);
        if (fileIndex !== -1) {
          sampleFiles.splice(fileIndex, 1);
          // Also save the updated files array to localStorage
          localStorage.setItem("files_data", JSON.stringify(sampleFiles));
        }

        // Update UI
        applyFiltersAndSort();
        renderFilesTable();

        showToast("Resource deleted successfully", "success");
      }

      // Confirm delete file
      function confirmDeleteFile(fileId) {
        if (
          confirm(
            "Are you sure you want to delete this file? This action cannot be undone."
          )
        ) {
          deleteFile(fileId);
        }
      }

      // Delete file function
      function deleteFile(fileId) {
        // Find the file index
        const index = sampleFiles.findIndex((f) => f.id === fileId);
        if (index === -1) return;

        // Only allow deleting own files
        if (sampleFiles[index].userId !== currentUser.id) {
          showToast("You can only delete your own files", "error");
          return;
        }

        // Remove from array
        sampleFiles.splice(index, 1);

        // Save changes to localStorage
        localStorage.setItem("files_data", JSON.stringify(sampleFiles));

        // Update UI
        renderFilesTable();

        showToast("File deleted successfully", "success");
      }

      // Modal functions
      function openUploadModal() {
        // Reset form first
        document.getElementById("uploadForm").reset();
        document.getElementById("uploadForm").removeAttribute("data-edit-id");
        document.getElementById("uploadModalLabel").textContent =
          "Upload Resource";
        document.getElementById("filePreview").style.display = "none";
        document.getElementById("fileDropArea").style.display = "block";
        document.getElementById("coverImagePreview").src = "";
        document.getElementById("coverImagePreview").style.display = "none";

        // Reset tags
        document.querySelectorAll(".tag-option").forEach((tag) => {
          tag.classList.remove("selected");
        });
        document.getElementById("selectedTags").value = "";

        // Show modal
        const modal = new bootstrap.Modal(
          document.getElementById("uploadModal")
        );
        modal.show();
      }

      function closeUploadModal() {
        const modal = bootstrap.Modal.getInstance(
          document.getElementById("uploadModal")
        );
        if (modal) modal.hide();
      }

      // File selection handling
      document
        .getElementById("fileInput")
        .addEventListener("change", function (e) {
          const file = e.target.files[0];
          if (file) {
            document.getElementById("filePreview").style.display = "flex";
            document.getElementById("selectedFileName").textContent = file.name;
            document.getElementById("fileDropArea").style.display = "none";

            // Auto-fill the title with the filename (without extension)
            const fileName = file.name.replace(/\.[^/.]+$/, "");
            document.getElementById("resourceTitle").value = fileName;

            // Auto-select type based on file extension
            const extension = file.name.split(".").pop().toLowerCase();
            const categorySelect = document.getElementById("resourceCategory");

            if (extension === "pdf") {
              for (let i = 0; i < categorySelect.options.length; i++) {
                if (categorySelect.options[i].value === "reference") {
                  categorySelect.selectedIndex = i;
                  break;
                }
              }
            } else if (extension === "ppt" || extension === "pptx") {
              for (let i = 0; i < categorySelect.options.length; i++) {
                if (categorySelect.options[i].value === "lecture") {
                  categorySelect.selectedIndex = i;
                  break;
                }
              }
            }
          }
        });

      // Cover image preview
      document
        .getElementById("coverImageInput")
        .addEventListener("change", function(e) {
          const file = e.target.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
              const preview = document.getElementById("coverImagePreview");
              preview.src = e.target.result;
              preview.style.display = "block";
            };
            reader.readAsDataURL(file);
          } else {
            document.getElementById("coverImagePreview").style.display = "none";
          }
        });

      // Remove selected file
      function removeSelectedFile() {
        document.getElementById("fileInput").value = "";
        document.getElementById("filePreview").style.display = "none";
        document.getElementById("fileDropArea").style.display = "block";
      }

      // Handle tag selection
      document.querySelectorAll(".tag-option").forEach((tagOption) => {
        tagOption.addEventListener("click", function () {
          const selectedTags = document.querySelectorAll(
            ".tag-option.selected"
          );

          if (this.classList.contains("selected")) {
            // Deselect tag
            this.classList.remove("selected");
          } else if (selectedTags.length < 3) {
            // Select tag if less than 3 are selected
            this.classList.add("selected");
          } else {
            showToast("You can select up to 3 tags", "error");
          }

          // Update hidden field with selected tags
          const tags = [];
          document
            .querySelectorAll(".tag-option.selected")
            .forEach((selected) => {
              tags.push(selected.getAttribute("data-tag"));
            });
          document.getElementById("selectedTags").value = tags.join(",");
        });
      });

      // Handle form submission
      document
        .getElementById("uploadForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const editId = this.getAttribute("data-edit-id");
          const isEditing = !!editId;

          // Get form values
          const title = document.getElementById("resourceTitle").value.trim();
          const description = document
            .getElementById("resourceDesc")
            .value.trim();
          const category = document.getElementById("resourceCategory").value;
          const tagsValue = document.getElementById("selectedTags").value;
          const tags = tagsValue
            ? tagsValue.split(",").map((t) => {
                // Capitalize first letter
                return t.trim().charAt(0).toUpperCase() + t.trim().slice(1);
              })
            : [];

          let fileType;
          let fileName;
          let fileSize;
          
          // Process cover image
          const coverImageInput = document.getElementById("coverImageInput");
          let coverImageUrl = "";
          
          if (coverImageInput.files && coverImageInput.files[0]) {
            const coverImageFile = coverImageInput.files[0];
            // Create a data URL from the file (base64 encoded)
            coverImageUrl = document.getElementById("coverImagePreview").src;
          } else if (isEditing) {
            // Keep existing cover image if editing
            const resource = sampleResources.find(r => r.id === editId);
            if (resource) {
              coverImageUrl = resource.coverImage || "";
            }
          }

          if (isEditing) {
            // We're editing an existing resource
            const resource = sampleResources.find((r) => r.id === editId);
            fileType = resource.type;
            fileName = resource.title + "." + resource.type;
            fileSize = resource.size;
          } else {
            // New upload - validate file
            const fileInput = document.getElementById("fileInput");

            if (!fileInput.files || fileInput.files.length === 0) {
              showToast("Please select a file to upload", "error");
              return;
            }

            const file = fileInput.files[0];
            fileName = file.name;

            // Check file type
            const extension = fileName.split(".").pop().toLowerCase();
            if (!["pdf", "doc", "docx", "ppt", "pptx"].includes(extension)) {
              showToast("Only PDF, DOCX, or PPT files are allowed", "error");
              return;
            }

            fileType =
              extension === "pdf"
                ? "pdf"
                : extension === "doc" || extension === "docx"
                ? "docx"
                : "ppt";

            // Format size
            fileSize = (file.size / 1024 / 1024).toFixed(1) + " MB";
          }

          // Add the file to both resources and files table
          if (isEditing) {
            // Update existing resource
            const resourceIndex = sampleResources.findIndex(
              (r) => r.id === editId
            );
            if (resourceIndex !== -1) {
              sampleResources[resourceIndex] = {
                ...sampleResources[resourceIndex],
                title: title,
                desc: description,
                tags: tags,
                category: category,
                updated: new Date().toISOString(),
                coverImage: coverImageUrl
              };

              // Also update the file table entry if it exists
              const fileIndex = sampleFiles.findIndex((f) => f.id === editId);
              if (fileIndex !== -1) {
                sampleFiles[fileIndex] = {
                  ...sampleFiles[fileIndex],
                  name: title + "." + fileType,
                };
              }
              localStorage.setItem(
                "resources_data",
                JSON.stringify(sampleResources)
              );
              localStorage.setItem("files_data", JSON.stringify(sampleFiles));
            }

            showToast("Resource updated successfully", "success");
          } else {
            // Add new resource
            const resourceId = "res-" + Date.now();
            const now = new Date().toISOString();

            sampleResources.unshift({
              id: resourceId,
              title: title,
              coverImage: coverImageUrl,
              desc: description || "",
              tags: tags,
              category: category,
              by: currentUser.name,
              userId: currentUser.id,
              date: now,
              type: fileType,
              size: fileSize,
              url: "#",
              downloads: 0,
              views: 0,
            });

            sampleFiles.unshift({
              id: resourceId,
              name: title + "." + fileType,
              by: currentUser.name,
              userId: currentUser.id,
              date: now,
              uploadDate: now,
              type: fileType.toUpperCase(),
              size: fileSize,
              url: "#",
              downloads: 0,
            });
            localStorage.setItem(
              "resources_data",
              JSON.stringify(sampleResources)
            );
            localStorage.setItem("files_data", JSON.stringify(sampleFiles));
            showToast("Resource uploaded successfully", "success");
          }

          closeUploadModal();
          applyFiltersAndSort();
          renderFilesTable();
        });

      // File drag and drop functionality
      const dropArea = document.getElementById("fileDropArea");

      ["dragenter", "dragover", "dragleave", "drop"].forEach((eventName) => {
        dropArea.addEventListener(eventName, preventDefaults, false);
      });

      function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
      }

      ["dragenter", "dragover"].forEach((eventName) => {
        dropArea.addEventListener(eventName, highlight, false);
      });

      ["dragleave", "drop"].forEach((eventName) => {
        dropArea.addEventListener(eventName, unhighlight, false);
      });

      function highlight() {
        dropArea.classList.add("highlight");
      }

      function unhighlight() {
        dropArea.classList.remove("highlight");
      }

      dropArea.addEventListener("drop", handleDrop, false);

      function handleDrop(e) {
        const dt = e.dataTransfer;
        const files = dt.files;

        if (files.length) {
          document.getElementById("fileInput").files = files;
          // Trigger the change event manually
          const event = new Event("change");
          document.getElementById("fileInput").dispatchEvent(event);
        }
      }

      // Show toast notification
      function showToast(message, type = "success") {
        const toastContainer = document.getElementById("toastContainer");
        const id = "toast-" + Date.now();

        const toast = document.createElement("div");
        toast.className = `toast ${type}`;
        toast.id = id;

        toast.innerHTML = `
      <div class="toast-icon ${type}">
        <i class="bi bi-${
          type === "success" ? "check-circle" : "exclamation-circle"
        }"></i>
      </div>
      <div class="toast-content">
        <div class="toast-title">${
          type === "success" ? "Success" : "Error"
        }</div>
        <div class="toast-message">${message}</div>
      </div>
      <button class="toast-close" onclick="closeToast('${id}')">
        <i class="bi bi-x"></i>
      </button>
    `;

        toastContainer.appendChild(toast);

        // Auto remove after 5 seconds
        setTimeout(() => {
          closeToast(id);
        }, 5000);
      }

      // Close toast notification
      window.closeToast = function (id) {
        const toast = document.getElementById(id);
        if (toast) {
          toast.style.opacity = "0";
          toast.style.transform = "translateX(100%)";
          setTimeout(() => {
            toast.remove();
          }, 300);
        }
      };

      // Initialize lazy loading for images
      function initLazyLoading() {
        const lazyImages = document.querySelectorAll(".lazy-image");

        lazyImages.forEach((img) => {
          img.onload = function () {
            this.classList.add("loaded");
          };
        });
      }

      // Sidebar toggle
      const menuToggle = document.getElementById("menuToggle");
      const sidebar = document.getElementById("sidebar");
      const mainContent = document.getElementById("mainContent");

      menuToggle.addEventListener("click", function () {
        sidebar.classList.toggle("open");
        mainContent.classList.toggle("shifted");
      });

      document.addEventListener("click", function (event) {
        if (window.innerWidth <= 768) {
          if (
            !sidebar.contains(event.target) &&
            !menuToggle.contains(event.target)
          ) {
            sidebar.classList.remove("open");
            mainContent.classList.remove("shifted");
          }
        }
      });

      function goToProfile() {
        showToast("Redirecting to profile page", "success");
        // In a real app, you would navigate to the profile page
      }

      // Search functionality
      const searchInput = document.getElementById("resourceSearch");
      const clearSearch = document.getElementById("clearSearch");

      searchInput.addEventListener("input", function () {
        state.currentSearch = this.value.trim().toLowerCase();

        // Show/hide clear button
        if (state.currentSearch.length > 0) {
          clearSearch.classList.add("visible");
        } else {
          clearSearch.classList.remove("visible");
        }

        applyFiltersAndSort();
      });

      clearSearch.addEventListener("click", function () {
        searchInput.value = "";
        state.currentSearch = "";
        this.classList.remove("visible");
        applyFiltersAndSort();
      });

      // Set up view toggling
      document
        .getElementById("gridViewBtn")
        .addEventListener("click", function () {
          setViewMode("grid");
        });

      document
        .getElementById("listViewBtn")
        .addEventListener("click", function () {
          setViewMode("list");
        });

      // Set up sort dropdown handler
      document
        .getElementById("sortDropdown")
        .addEventListener("change", function () {
          state.currentSort = this.value;
          applyFiltersAndSort();
        });

      // Set up table sort handler
      document
        .getElementById("tableSort")
        .addEventListener("change", function () {
          state.tableSort = this.value;
          renderFilesTable(state.tableSort);
        });

      // Initialize page
      document.addEventListener("DOMContentLoaded", function () {
        // Initialize theme
        initializeTheme();
        
        loadUserData();
        applyFiltersAndSort();
        renderFilesTable();

        // Set current date in UI (example for demo)
        const currentDateElements = document.querySelectorAll(".current-date");
        const formattedDate = new Date().toLocaleDateString("en-US", {
          year: "numeric",
          month: "long",
          day: "numeric",
        });

        currentDateElements.forEach((el) => {
          el.textContent = formattedDate;
        });

        // Show welcome notification if this is first visit
        if (!localStorage.getItem("resource_page_visited")) {
          setTimeout(() => {
            showToast(
              "Welcome to the Resources page! You can upload and manage study materials here.",
              "success"
            );
            localStorage.setItem("resource_page_visited", "true");
          }, 1000);
        }
        
        console.log(`Resources page loaded for ${CURRENT_SESSION.user} at ${CURRENT_SESSION.utcTime} UTC`);
      });
    </script>
  </body>
</html>